<!doctype html>
<html lang="it">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Contatore Bestia</title>
    <link rel="stylesheet" href="style.css" />
    <script src="script.js" defer></script>
</head>
<body>
<div class="container">
    <header class="topbar">
        <div>
            <h1>Contatore Bestia</h1>
            <p class="small muted">
                Inserisci i giocatori (ordine: chi fa le carte, poi il prossimo, ecc). Chiudi le iscrizioni (posta), poi â€œAvvia manoâ€.
            </p>
        </div>

        <div class="top-actions">
            <div class="bestia-pill">
                Bestia: <strong id="bestiaTop">â‚¬ 0,00</strong>
            </div>
            <button id="settleBtn" class="btn-primary" title="Calcola chi deve dare a chi" disabled>ğŸ’¸ Chiudi conti</button>
            <button id="undoBtn" title="Annulla">â†©ï¸ Annulla</button>
            <button id="resetBtn" class="btn-red" title="Resetta">ğŸ§¹ Reset</button>
        </div>
    </header>

    <div class="grid">
        <!-- SINISTRA -->
        <section class="card">
            <h2 class="section-title">ğŸ§‘â€ğŸ¤â€ğŸ§‘ Giocatori</h2>

            <!-- Inserimento iniziale / solo quando bestia = 0 -->
            <div id="addWrap" class="row cols-3">
                <div>
                    <label class="small muted">Nome giocatore</label>
                    <input id="newName" placeholder="Es. Marco" />
                    <p class="small muted" id="addHint" style="margin-top:6px"></p>
                </div>
                <div style="align-self:end">
                    <button id="addPlayerBtn" class="btn-primary" style="width:100%">â• Aggiungi</button>
                </div>
                <div style="align-self:end">
                    <button id="lockBtn" class="btn-blue" style="width:100%">ğŸ”’ Chiudi iscrizioni</button>
                </div>
            </div>

            <!-- tabella giocatori (solo setup / quando bestia=0) -->
            <div id="playersTableWrap" class="mt-8">
                <table class="table">
                    <thead id="playersHead"></thead>
                    <tbody id="playersBody"></tbody>
                </table>
            </div>

            <!-- Storico mani -->
            <div id="historyWrap" class="mt-12">
                <h3 class="section-title">ğŸ§¾ Storico mani (Î” per giocatore)</h3>
                <div class="scroll-x">
                    <table class="table" id="historyTable"></table>
                </div>
            </div>
        </section>

        <!-- DESTRA -->
        <section class="card" id="settingsCard">
            <h2 class="section-title">âš™ï¸ Impostazioni partita</h2>

            <div class="row cols-3">
                <div id="stakeBlock">
                    <label class="small muted">Posta del mazziere (fissa)</label>
                    <input id="gameStakeInput" type="number" step="0.01" value="0.30" />
                    <p class="small muted">Viene fissata alla chiusura iscrizioni.</p>
                </div>

                <div id="dealerBlock">
                    <label class="small muted">Mazziere attuale (ordine dâ€™inserimento)</label>
                    <div class="dealer-pill" id="dealerName">â€”</div>
                    <p class="small muted" id="dealerHint" style="margin-top:6px"></p>
                </div>

                <div style="align-self:end">
                    <button id="startRound" class="btn-green" style="width:100%">â–¶ï¸ Avvia mano</button>
                </div>
            </div>

            <!-- Bestia corrente -->
            <div class="mt-12 potBox potBoxSticky" id="potValBox">
                <div class="label">Bestia corrente</div>
                <div id="potVal" class="pot-big">â‚¬ 0,00</div>
            </div>
        </section>
    </div>
</div>

<!-- MODALE: Partecipanti -->
<dialog id="participantsModal">
    <form method="dialog" class="modal">
        <h3 class="section-title">Chi gioca questa mano?</h3>
        <p class="small muted" id="participantsOrderHint" style="margin-top:-6px"></p>
        <div id="participantsList" class="list"></div>
        <div class="footer">
            <button id="participantsConfirm" class="btn-green">Avanti</button>
        </div>
    </form>
</dialog>

<!-- MODALE: Non partecipanti -->
<dialog id="npModal">
    <form method="dialog" class="modal">
        <h3 class="section-title">Non partecipanti: rientro o gruppi</h3>

        <div class="row cols-2">
            <div>
                <label class="small muted">In quanti volete rientrare?</label>
                <div id="npSizeWrap" class="row cols-3"></div>

                <div class="small muted" style="margin:10px 0 6px">Combinazioni possibili</div>
                <div id="npGroupCombos" class="list"></div>

                <div class="small muted" style="margin:10px 0 6px">Gruppi selezionati</div>
                <div id="npSelectedList" class="list"></div>
            </div>

            <div>
                <label class="small muted">Rientri da solo?</label>
                <div id="npSoloList" class="list"></div>
            </div>
        </div>

        <div class="footer">
            <button id="npBack" class="btn-blue" value="cancel">â† Indietro</button>
            <button id="npNext" class="btn-green">Avanti</button>
        </div>
    </form>
</dialog>

<!-- MODALE: Vincitori -->
<dialog id="winnersModal">
    <form method="dialog" class="modal">
        <h3 class="section-title">Assegna 1Âª / 2Âª / 3Âª</h3>

        <div class="row cols-3 winners-grid">
            <div>
                <div class="small muted center" id="hand1Title">1Âª mano</div>
                <div id="hand1" class="list tight"></div>
            </div>
            <div>
                <div class="small muted center" id="hand2Title">2Âª mano</div>
                <div id="hand2" class="list tight"></div>
            </div>
            <div>
                <div class="small muted center" id="hand3Title">3Âª mano</div>
                <div id="hand3" class="list tight"></div>
            </div>
        </div>

        <div class="footer">
            <button id="winnersBack" class="btn-blue" value="cancel">â† Indietro</button>
            <button id="winnersConfirm" class="btn-green" disabled>Chiudi mano</button>
        </div>
    </form>
</dialog>

<!-- MODALE: Esito mano -->
<dialog id="resultModal">
    <form method="dialog" class="modal">
        <h3 class="section-title">ğŸ§® Esito mano</h3>
        <div id="resultSummary"></div>
        <div class="footer">
            <button class="btn-blue">OK</button>
        </div>
    </form>
</dialog>

<!-- MODALE: Chiudi conti -->
<dialog id="settlementModal">
    <form method="dialog" class="modal">
        <h3 class="section-title">ğŸ’¸ Chi deve dare a chi</h3>
        <div id="settlementBody"></div>
        <div class="footer">
            <button class="btn-blue">OK</button>
        </div>
    </form>
</dialog>

</body>
</html>
