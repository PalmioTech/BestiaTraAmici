<!doctype html>
<html lang="it">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Contatore Bestia</title>
    <link rel="stylesheet" href="style.css" />
    <script src="script.js" defer></script>
    <link rel="manifest" href="manifest.webmanifest">
    <meta name="theme-color" content="#fff7ed">
    <!-- iOS: icone & status bar -->
    <link rel="apple-touch-icon" >
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">

</head>
<body>
<div class="container">
    <header class="topbar">
        <div>
            <h1>Contatore Bestia</h1>
            <p class="small muted">Inserisci i giocatori, chiudi le iscrizioni (imposta la posta), poi usa â€œAvvia manoâ€.</p>
        </div>
        <div class="top-actions">
            <button id="undoBtn" title="Annulla">â†©ï¸ Annulla</button>
            <button id="resetBtn" class="btn-red" title="Resetta">ğŸ§¹ Reset</button>
        </div>
    </header>

    <div class="grid">
        <!-- SINISTRA: Giocatori + Storico -->
        <section class="card">
            <h2 class="section-title">ğŸ§‘â€ğŸ¤â€ğŸ§‘ Giocatori</h2>

            <!-- inserimento iniziale -->
            <div id="addWrap" class="row cols-3">
                <div>
                    <label class="small muted">Nome giocatore</label>
                    <input id="newName" placeholder="Es. Marco" />
                </div>
                <div style="align-self:end">
                    <button id="addPlayerBtn" class="btn-primary" style="width:100%">â• Aggiungi</button>
                </div>
                <div style="align-self:end">
                    <button id="lockBtn" class="btn-blue" style="width:100%">ğŸ”’ Chiudi iscrizioni</button>
                </div>
            </div>

            <!-- tabella giocatori (solo in setup) -->
            <div id="playersTableWrap" class="mt-8">
                <table class="table">
                    <thead id="playersHead"></thead>
                    <tbody id="playersBody"></tbody>
                </table>
            </div>

            <!-- Storico mani -->
            <div id="historyWrap" class="mt-12">
                <h3 class="section-title">ğŸ§¾ Storico mani (Î” per giocatore)</h3>
                <div class="scroll-x">
                    <table class="table" id="historyTable"></table>
                </div>
            </div>
        </section>

        <!-- DESTRA: Impostazioni e bestia -->
        <section class="card" id="settingsCard">
            <h2 class="section-title">âš™ï¸ Impostazioni partita</h2>

            <div class="row cols-3">
                <div id="stakeBlock">
                    <label class="small muted">Posta del mazziere (fissa)</label>
                    <input id="gameStakeInput" type="number" step="0.01" value="0.30" />
                </div>
                <div style="align-self:end">
                    <button id="startRound" class="btn-green" style="width:100%">â–¶ï¸ Avvia mano</button>
                </div>
            </div>

            <!-- Bestia corrente (in rilievo) -->
            <div class="mt-12 potBox" id="potValBox">
                <div class="label">Bestia corrente</div>
                <div id="potVal" class="pot-big">â‚¬ 0,00</div>
            </div>
        </section>
    </div>
</div>

<!-- MODALE: Partecipanti -->
<dialog id="participantsModal">
    <form method="dialog" class="modal">
        <h3 class="section-title">Chi gioca questa mano?</h3>
        <div id="participantsList" class="list"></div>
        <div class="footer">
            <button id="participantsConfirm" class="btn-green">Avanti</button>
        </div>
    </form>
</dialog>

<!-- MODALE: Non partecipanti (rientro/gruppi) -->
<dialog id="npModal">
    <form method="dialog" class="modal">
        <h3 class="section-title">Non partecipanti: rientro o gruppi</h3>

        <div class="row cols-2">
            <div>
                <label class="small muted">In quanti volete rientrare?</label>
                <div id="npSizeWrap" class="row cols-3">
                    <div class="choice center" data-size="2">2</div>
                    <div class="choice center" data-size="3">3</div>
                    <div class="choice center" data-size="4">4</div>
                </div>
                <div class="small muted" style="margin:10px 0 6px">Combinazioni possibili</div>
                <div id="npGroupCombos" class="list"></div>
            </div>

            <div>
                <label class="small muted">Rientri da solo?</label>
                <div id="npSoloList" class="list"></div>
            </div>
        </div>

        <!-- Gruppi selezionati (persistono) -->
        <div class="mt-8">
            <div class="small muted">Gruppi selezionati</div>
            <div id="npGroupsList" class="list"></div>
        </div>

        <div class="footer">
            <button id="npNext" class="btn-blue">Avanti</button>
        </div>
    </form>
</dialog>

<!-- MODALE: Vincitori 1Âª/2Âª/3Âª -->
<dialog id="winnersModal">
    <form method="dialog" class="modal">
        <h3 class="section-title">Assegna 1Âª / 2Âª / 3Âª</h3>
        <div class="row cols-3 winners-grid">
            <div>
                <div class="small muted center" id="hand1Title">1Âª mano</div>
                <div id="hand1" class="list tight"></div>
            </div>
            <div>
                <div class="small muted center" id="hand2Title">2Âª mano</div>
                <div id="hand2" class="list tight"></div>
            </div>
            <div>
                <div class="small muted center" id="hand3Title">3Âª mano</div>
                <div id="hand3" class="list tight"></div>
            </div>
        </div>
        <div class="footer">
            <button id="winnersConfirm" class="btn-green" disabled>Chiudi mano</button>
        </div>
    </form>
</dialog>

<!-- MODALE: Riepilogo esito -->
<dialog id="resultModal">
    <form method="dialog" class="modal">
        <h3 class="section-title">ğŸ§® Esito mano</h3>
        <div id="resultSummary"></div>
        <div class="footer">
            <button class="btn-blue">OK</button>
        </div>
    </form>
</dialog>
</body>
</html>
