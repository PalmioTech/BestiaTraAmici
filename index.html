<!doctype html>
<html lang="it">
<head>
    <link rel="manifest" href="manifest.webmanifest">

    <!-- iOS -->
    <link rel="apple-touch-icon" href="icon.png">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">


    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Contatore Bestia</title>
    <link rel="stylesheet" href="style.css" />
    <script src="script.js" defer></script>
</head>
<body>
<div class="container">
    <header class="appHeader">
        <div class="titleBlock">
            <h1>Contatore Bestia</h1>
        </div>

        <div class="potSticky" id="potSticky">
            <div class="potSticky-label">Bestia</div>
            <div class="potSticky-value" id="potValTop">‚Ç¨ 0,00</div>
        </div>

        <div class="headerActions">
            <button id="accountsBtn" class="btn-primary">üí∏ Conti</button>
            <button id="undoBtn" class="btn-blue">‚Ü©Ô∏è Annulla</button>
            <button id="resetBtn" class="btn-red">üßπ Reset</button>
        </div>
    </header>


    <div class="grid">
        <!-- SINISTRA: Giocatori + Storico -->
        <section class="card">
            <h2 class="section-title">üßë‚Äçü§ù‚Äçüßë Giocatori</h2>

            <!-- inserimento iniziale -->
            <div id="addWrap" class="row cols-3">
                <div>
                    <label class="small muted">Nome giocatore</label>
                    <input id="newName" placeholder="Es. Marco" />
                    <p class="small muted">Ordine: 1=fa le carte ora, 2=le far√† dopo, ecc.</p>
                </div>
                <div style="align-self:end">
                    <button id="addPlayerBtn" class="btn-primary" style="width:100%">‚ûï Aggiungi</button>
                </div>
                <div style="align-self:end">
                    <button id="lockBtn" class="btn-blue" style="width:100%">üîí Chiudi iscrizioni</button>
                </div>
            </div>

            <!-- tabella giocatori (solo in setup) -->
            <div id="playersTableWrap" class="mt-8">
                <table class="table">
                    <thead id="playersHead"></thead>
                    <tbody id="playersBody"></tbody>
                </table>
            </div>

            <!-- Storico mani -->
            <div id="historyWrap" class="mt-12">
                <h3 class="section-title">üßæ Storico mani (Œî per giocatore)</h3>
                <div class="scroll-x">
                    <table class="table" id="historyTable"></table>
                </div>
            </div>
        </section>

        <!-- DESTRA: Impostazioni partita -->
        <section class="card" id="settingsCard">
            <h2 class="section-title">‚öôÔ∏è Impostazioni partita</h2>

            <div class="row cols-2">

                <div style="align-self:end">
                    <button id="startRound" class="btn-green" style="width:100%">‚ñ∂Ô∏è Avvia mano</button>
                </div>
            </div>

            <div class="mt-12">
                <button id="openSettings" class="btn-blue" style="width:100%">
                    ‚öôÔ∏è Impostazioni giocatori
                </button>
            </div>
        </section>
    </div>
</div>

<!-- MODALE: Partecipanti -->
<dialog id="participantsModal">
    <form method="dialog" class="modal">
        <h3 class="section-title">Chi gioca questa mano?</h3>
        <div id="participantsList" class="list"></div>
        <div class="footer">
            <button id="participantsConfirm" class="btn-green">Avanti</button>
        </div>
    </form>
</dialog>

<!-- MODALE: Non partecipanti -->
<dialog id="npModal">
    <form method="dialog" class="modal">
        <h3 class="section-title">Non partecipanti: rientro o gruppi</h3>

        <div class="row cols-2">
            <div>
                <label class="small muted">In quanti volete rientrare?</label>
                <div id="npSizeWrap" class="row cols-3"></div>

                <div class="small muted" style="margin:10px 0 6px">Combinazioni possibili</div>
                <div id="npGroupCombos" class="list"></div>
                <!-- qui JS aggiunge "Gruppi selezionati" -->
            </div>

            <div>
                <label class="small muted">Rientri da solo?</label>
                <div id="npSoloList" class="list"></div>
            </div>
        </div>

        <div class="footer">
            <button id="npBack" class="btn-blue">Indietro</button>
            <button id="npNext" class="btn-green">Avanti</button>
        </div>
    </form>
</dialog>

<!-- MODALE: Vincitori -->
<dialog id="winnersModal">
    <form method="dialog" class="modal">
        <h3 class="section-title">Assegna 1¬™ / 2¬™ / 3¬™</h3>

        <div class="row cols-3 winners-grid">
            <div>
                <div class="small muted center" id="hand1Title">1¬™ mano</div>
                <div id="hand1" class="list tight"></div>
            </div>
            <div>
                <div class="small muted center" id="hand2Title">2¬™ mano</div>
                <div id="hand2" class="list tight"></div>
            </div>
            <div>
                <div class="small muted center" id="hand3Title">3¬™ mano</div>
                <div id="hand3" class="list tight"></div>
            </div>
        </div>

        <div class="footer">
            <button id="winnersConfirm" class="btn-green" disabled>Chiudi mano</button>
        </div>
    </form>
</dialog>

<!-- MODALE: Riepilogo -->
<dialog id="resultModal">
    <form method="dialog" class="modal">
        <h3 class="section-title">üßÆ Esito mano</h3>
        <div id="resultSummary"></div>
        <div class="footer">
            <button class="btn-blue">OK</button>
        </div>
    </form>
</dialog>

<!-- MODALE: Impostazioni giocatori -->
<dialog id="settingsModal">
    <form method="dialog" class="modal">
        <h3 class="section-title">‚öôÔ∏è Impostazioni giocatori</h3>

        <p class="small muted">
            Puoi aggiungere/rinominare/riordinare solo quando la Bestia √® ‚Ç¨ 0,00 (e nessuna mano √® in corso).
        </p>

        <div class="row cols-2 mt-8">
            <div>
                <label class="small muted">Nuovo giocatore</label>
                <input id="settingsNewName" placeholder="Es. Luca" />
            </div>
            <div style="align-self:end">
                <button id="settingsAddBtn" class="btn-primary" style="width:100%">‚ûï Aggiungi</button>
            </div>
        </div>

        <div class="mt-12">
            <div class="small muted" style="margin-bottom:6px">Ordine giocatori (1 = fa le carte ora)</div>
            <div id="settingsPlayersList" class="row" style="gap:10px"></div>
        </div>

        <div class="footer">
            <button class="btn-blue">Chiudi</button>
        </div>
    </form>
</dialog>
<!-- MODALE: Conti finali -->
<dialog id="accountsModal">
    <form method="dialog" class="modal">
        <h3 class="section-title">üí∏ Conti (chi d√† a chi)</h3>
        <p class="small muted" style="margin-top:-6px">
            Basato sui totali attuali. Se finisse ora, questi pagamenti chiudono i conti.
        </p>
        <div id="accountsSummary" class="mt-8"></div>

        <div class="footer">
            <button class="btn-blue">OK</button>
        </div>
    </form>
</dialog>

</body>
</html>
